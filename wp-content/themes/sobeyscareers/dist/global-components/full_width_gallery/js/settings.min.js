function check_form_validation(){$(".fl-builder-settings-save").hide(),image_id=$("#fl-field-image input").val(),video_id=$("#fl-field-youtube_post_id select").val(),type=$("#fl-field-type select").val(),image_id.indexOf("dummyimage")&&$(".fl-builder-settings-save").show(),"image"==type&&0<parseInt(image_id)&&$(".fl-builder-settings-save").show(),"video"==type&&0<parseInt(video_id)&&$(".fl-builder-settings-save").show()}function bb_render_visual_preview(e,i){$(".fl-builder-field-multiple input").change(function(){fetch_field_data(this,e,i)}),$(".fl-builder-field-multiple input").each(function(){fetch_field_data(this,e,i)})}function fetch_field_data(e,i,l){if($(e).siblings(".fl-form-field-preview-text").html(""),val=$(e).val(),object=jQuery.parseJSON(val),object&&val){lookup_id=object[i],lookup_type=object[l];var t="rendering_"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);if($(e).siblings(".fl-form-field-preview-text").addClass(t),lookup_id)if("image"==lookup_type){if(0<lookup_id.indexOf("dummyimage"))return void add_preview_image(lookup_id,"",t);$.ajax({url:wpApiSettings.root+"wp/v2/media/"+lookup_id,method:"GET"}).done(function(e){add_preview_image(e.source_url,"",t)})}else"video"==lookup_type&&$.ajax({url:wpApiSettings.root+"wp/v2/video/"+lookup_id+"?embed",method:"GET"}).done(function(e){e._links["wp:featuredmedia"]&&(lookup=e._links["wp:featuredmedia"][0].href,lookup&&$.getJSON(lookup,function(e){add_preview_image(e.source_url,"video",t)}))})}}function add_preview_image(e,i,l){e&&(html='<b class="overlay"></b><img src="'+e+'">',$(".fl-form-field-preview-text."+l).html(html).removeClass(l).removeClass("video").addClass(i))}function monitor_preview_field(){$("#fl-field-preview_field").hide(),jQuery("body").on("click",".media-toolbar-primary",function(){val=$('[name="image"]').val(),$('[name="preview_field"]').val(val).attr("value",val).trigger("change")}),$('[name="youtube_post_id"], [name="image"]').change(function(){val=$(this).val(),"add"!=val&&""!=val&&$('[name="preview_field"]').val(val).attr("value",val).trigger("change")})}!function(e){FLBuilder._registerModuleHelper("gallery_item",{rules:{preview_field:{required:!0}},init:function(){bb_ajax_select_field_posts(),bb_rest_video_upload(),monitor_preview_field(),check_form_validation(),e("body").on("click",".media-toolbar-primary",function(){check_form_validation()}),e("#fl-field-type select, #fl-field-youtube_post_id select").change(function(){check_form_validation()})}}),FLBuilder._registerModuleHelper("full_width_gallery",{rules:{"gallery_items[]":{mincount:3,maxcount:6,required_json:{preview_field:!0}},intro_content:{maxlengthhtml:60}},init:function(){monitor_repeater_length(),restrict_editor_height(),bb_render_visual_preview("preview_field","type"),e("body").on("click",".fl-builder-field-add",function(e){e.preventDefault(),bb_render_visual_preview("preview_field","type")})}})}(jQuery);