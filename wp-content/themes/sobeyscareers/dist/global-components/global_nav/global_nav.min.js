!function(a){if($global_nav=a("[data-js-global-nav]"),$global_nav.length){var n,e=[],t=a("#site-nav-header").outerHeight(),l="#site-nav-header #menu-icon",i=a(l),s="ul#primary-menu",o="li.menu-item",d="li.menu-item.menu-item-has-children",r="li.menu-item a",c="li.primary-menu-item",g=".gn-panel",u="#gn-panel-",v="ul.sub-menu",f="[data-js-menu-nav-level='0']",b=".current-menu-ancestor",h=".current-menu-item",p="js-menu-nav-id",m="js-menu-nav-level",_="-open",C="-close",$="-menu-open",y='<li class="menu-item bc-menu-item"><a>%s</a></li>',w=2,x=0;a(document).ready(function(){!function(){$global_nav.show(),a(c).eq(a(c).length-1).addClass("primary-menu-item-last"),$global_nav.find(s+" "+o).each(function(n){a(this).attr("data-"+p,n);var e=function(a){$el=D(a);var n=$el.closest("ul").attr("class").match("gn-level-([0-9]+)");if(n)var e=n[1];return e}(n);a(this).attr("data-"+m,e)}),$global_nav.find(s+" > "+o).each(function(n){a(this).attr("data-"+m,0)}),$global_nav.find(g).each(function(n){var e=a(this).closest(o);a(this).attr("id","gn-panel-"+e.data(p))}),$global_nav.find(g).each(function(n){var e=a(this).closest(o),t=e.find("> a").text(),l=y.replace("%s",t),i=a(l);i.addClass("bc-menu-item-label"),i.find("> a").attr("tabindex","-1");var s=e.closest(v).closest(o),d=s.find("> a").text(),r=y.replace("%s",d),c=a(r);c.find("> a").attr("tabindex","-1"),c.attr("data-"+p,e.data(p)-1);var g=s.closest("ul").closest(o);g.find("> a").text();var u=y.replace("%s","Main menu"),f=a(u);f.find("> a").attr("tabindex","-1"),f.attr("data-"+p,-1),a(this).prepend(i),a(this).prepend(c),a(this).prepend(f)}),t=document.createElement("div"),t.className="gn-panels",a(s).after(t),a(".gn-panels").append(a(g)),a(document).on("click",l,S),$global_nav.find(r).on("click",E),a("a").keydown(function(n){a(this).is(":focus")&&void 0===a(this).attr("href")&&13===n.which&&a(this).click()}),a(document).on("menu-close",q),function(){var n=$global_nav.find(g+" "+h).last();if(0===n.length){var t=$global_nav.find(s+" "+b).last();return void(t.length&&t.addClass(_))}$global_nav.find(b).closest(g).each(function(n){var t=a(this).attr("id").replace("gn-panel-","");e.push(t),$global_nav.find(u+t).addClass(_)});var l=n.closest(g).attr("id").replace("gn-panel-","");e.push(l),$global_nav.find(u+l).addClass(_),U("navigateToCurrent: "+e.toString())}(),M(),$global_nav.find(d).attr("aria-expanded","false"),a("body.fl-builder-edit").on("click","#bb_expand_main_menu",function(){q(),jQuery("#global-nav").height(0),height=jQuery("#site-nav-header").height()+1,menu_height=jQuery(document).height()-height,jQuery("#global-nav, .component_search, .component_header_communities, .component_header_websites").css("top",height),jQuery("#global-nav").height(menu_height).addClass("-open").show(),S()});var t;try{fpSetNavOffset()}catch(a){}a(window).resize(function(){try{fp_setNavOffset()}catch(a){}}),a(document).keydown(function(e){var t=e.which?e.which:e.KeyCode,l=a(".gn-panels .-open","#global-nav.-open");if(a("#global-nav").hasClass("-open"))switch(t){case 9:e.preventDefault(),k(),0==l.length?a(e).focus():a(n[1],"#global-nav.-open").focus().addClass("is-tabbing"),e.shiftKey?j():Q();break;case 40:e.preventDefault(),k(),0==l.length?a(e).focus():a(n[1],"#global-nav.-open").focus().addClass("is-tabbing"),Q();break;case 38:e.preventDefault(),k(),0==l.length?a(e).focus():a(n[1],"#global-nav.-open").focus().addClass("is-tabbing"),j();break;case 13:"menu-icon"==e.target.id?(a(e).removeClass("is-tabbing").trigger("click"),k()):k()}})}()}),window.opg_toggleNavMenu=function(){S()}}function k(){var e;null!=typeof w&&null!=w||(w=2,x=0),(n=new Array).push(a("#menu-icon.-open")),a("#global-nav.-open .gn-panel.-open").length?(a("#global-nav.-open .gn-panel.-open").each(function(){e=a(this)}),a("a",e).each(function(){n.push(a(this))})):a("#primary-menu","#global-nav.-open").is(":visible")&&a("#primary-menu a","#global-nav.-open").each(function(){a(this).is(":visible")&&n.push(a(this))});for(var t=0;t<n.length;t++)a(n[t]).hasClass("is-tabbing")&&(w=1+t==n.length?0:1+t,x=0>-1+t?n.length-1:-1+t)}function j(){var e=x-1;a("a.is-tabbing","#global-nav.-open").removeClass("is-tabbing"),a(n[x],"#global-nav.-open").attr("tabindex","0").focus().addClass("is-tabbing"),0==x&&(e=x.length-1),x=e}function Q(){var e=1+w;a("a.is-tabbing","#global-nav.-open").removeClass("is-tabbing"),a(n[w],"#global-nav.-open").attr("tabindex","0").focus().addClass("is-tabbing"),e==n.length&&(e=0),w=e}function D(n){return a("[data-"+p+'="'+n+'"]').eq(0)}function S(){a("body").hasClass($)?(console.log("close"),q()):(console.log("open"),a(".gn-panels").css("top",0),a(document).trigger("modal-close"),a("body").addClass($),i.addClass(_),$global_nav.addClass(_),H(),K(),a(document).bind("keyup",A),k())}function q(){a(".gn-panels").css("top",-1e5),a("body").removeClass($),i.removeClass(_),$global_nav.removeClass(_),T(),a(document).unbind("keyup",A)}function N(){$global_nav.find(s).removeClass(C),$global_nav.find(s).slideDown(0),K()}function T(){$global_nav.find(s+" > "+o+" > a").attr("tabindex","-1")}function H(){$global_nav.find(s+" > "+o+" > a").attr("tabindex","0")}function K(){$global_nav.find(s+" > "+o+" > a").eq(0).focus()}function M(){$global_nav.find(g+" a").attr("tabindex","-1"),T()}function O(a,n,t){if(U("slidePanel: panel_id: "+a),U("slidePanel: trail_length: "+t),M(),0===a)if($global_nav.find(u+n).removeClass(_),t){var l=e.pop();e.push(l),$global_nav.find(u+l+" a").attr("tabindex","0"),$global_nav.find(u+l+" a").eq(0).focus()}else H();else z(),$global_nav.find(u+a).addClass(_),$global_nav.find(u+a+" a").attr("tabindex","0");0<t?($global_nav.find(s).addClass(C),$global_nav.find(s).delay(500).slideUp(0)):N()}function P(n){U("navigate"),U("navigate: selected panel/nav_id: "+n);var l=D(n),i=l.data(m);if(U("navigate: : item_level: "+i),U("navigate: : nav_trail: "+e.toString()),-1==n)return U("navigate: slideHome, resetting nav_trail"),H(),N(),$global_nav.find(g).removeClass(_),$global_nav.find(s+" "+o).removeClass(_),void(e=[]);var d,r=0;if(e.length&&(r=e[e.length-1]),U("navigate: prev: "+r),n<r)for(;r>n;r--)e.pop(),O(0,r,e.length),U("navigate: : nav_trail pop: "+e.toString());else 0==i?(d=l,U("dropdown clicked"),d.hasClass(_)?(d.removeClass(_),d.attr("aria-expanded","false")):(a(f).removeClass(_),d.addClass(_),d.attr("aria-expanded","true"),U("dropdown: scrollTop el:"+d.offset().top),z(d.offset().top-t,400))):(e.push(n),O(n,r,e.length),U("navigate: : nav_trail push: "+e.toString()))}function z(a,n){a=void 0===a?0:a,n=void 0===n?0:n;$global_nav.animate({scrollTop:a},n)}function A(a){27===a.keyCode&&q()}function E(n){var e=a(this).closest(o);if(!e.closest(o).hasClass("menu-item-has-children")&&!e.hasClass("bc-menu-item"))return!0;n.preventDefault(),P(e.data(p))}function U(a){}}(jQuery);