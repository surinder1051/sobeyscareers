var index,current_elment_height,currentIndex,$timeElm,$timeElmActive,$timeElmboxes,total_h,mouseWheel,sized,height=0,totalHeight=0,secHeight=0,downHeight=0,totalIndex=0,scrollHeight=0,total_height=0,ua=navigator.userAgent.toLowerCase(),isAndroid=-1<ua.indexOf("android"),isChrome=-1<ua.indexOf("chrome");function initTimeline_on_rotate(){initTimeline()}function initTimeline(){setTimeout(function(){var e=jQuery(".component_timeline");e.find(".segments-main.active").attr("data-active_scroll_position",""),set_timeline_width(),set_timeline_height(),e.find(".desktop-tabs li.active:first").click(),e.css("opacity",100),text=e.find(".desktop-tabs li.active:first").text(),e.find(".menu-dropdown-mobile .select-styled").text(text),setTimeout(function(){scroll_to_active_task(e)},1e3)},100)}function scroll_to_active_task(e){($timeElm=e).find(".segments-main.active .active-task").length&&(scroll_position=$timeElm.find(".segments-main.active").attr("data-active_scroll_position"),scroll_position||(calc1=parseInt($timeElm.find(".segments-main.active").offset().top),calc2=parseInt($timeElm.find(".segments-main.active .active-task").offset().top),calc3=parseInt($timeElm.find(".segments-main.active").height())/2,scroll_position=calc2-calc1-calc3,$timeElm.find(".segments-main.active").attr("data-active_scroll_position",scroll_position)),$timeElm.find(".segments-main.active").stop().animate({scrollTop:scroll_position},{duration:1e3,easing:"easeInOutBack",complete:function(){console.log("complete. ("+scroll_position+")"),jQuery(".segments-main.active").scrollTop(scroll_position)}}),setTimeout(function(){timelineArrows()},1100))}function set_timeline_width(){var e=jQuery(".component_timeline");w=e.find(".timeline-container").width(),l=e.find(".segments-main").length,totalTimelineWidth=w*l,e.find(".segment-main-inner").css("width",totalTimelineWidth),e.find(".segments-main").css("display","block")}function set_timeline_height(){setTimeout(function(){var e=jQuery(".component_timeline");n=e.find(".segments-main.active:first .timeline-detail-container-box").length-1,0>n||(3<n&&(n=3),e.find(".segments-main").height("10000px"),parent_offset=e.find(".segments-main.active").offset().top,child_offset=e.find(".segments-main.active .timeline-detail-container-box:eq("+n+")").offset().top,child_height=e.find(".segments-main.active .timeline-detail-container-box:eq("+n+")").outerHeight(),view_height=child_offset-parent_offset+child_height+30,device_height=jQuery(window).height(),max_height=.6*device_height,view_height>max_height&&(view_height=max_height),e.find(".segments-main").height(view_height))},100)}function intractsection(e,t){jQuery(this).addClass("active");var i=jQuery(e).closest(".component_timeline").find(".timeline-detail-section-main");i.removeClass("active"),i.find(".timeline-detail").addClass("no-show"),i.find("."+t).removeClass("no-show"),jQuery("html, body").animate({scrollTop:jQuery(".timelines").offset().top},{duration:800,easing:"easeInOutBack"})}function slickSliderTimeline(){jQuery(".timelinecarousalvideo .carousel-control-prev").on("click",function(){jQuery(this).parent().carousel("prev")}),jQuery(".timelinecarousalvideo .carousel-control-next").on("click",function(){jQuery(this).parent().carousel("next")}),jQuery(".timelinecarousalphoto .carousel-control-prev").on("click",function(){jQuery(this).parent().carousel("prev")}),jQuery(".timelinecarousalphoto .carousel-control-next").on("click",function(){jQuery(this).parent().carousel("next")})}function openTimeline(e,t){jQuery("body").addClass("no_scroll");var i=jQuery(e).closest(".component_timeline"),n=jQuery(e).closest(".timeline-detail-container-box").find(".timeline-detail-section-main");n.show().addClass("is-open"),n.find(".timeline-detail").addClass("no-show"),n.find("."+t).removeClass("no-show"),jQuery(e).closest(".segments-main").find('[taonex="0"]').attr("taonex",-1),i.find('[taonex="0"]').attr("taonex",-1),n.find('[role="button"], .action-button img').attr("taonex","0"),"timelineinfo"===t?(n.find("button").removeClass("active"),n.find(".info-icon").addClass("active")):"timelinevideo"===t?(n.find("button").removeClass("active"),n.find(".play-icon").addClass("active")):(n.find("button").removeClass("active"),n.find(".photo-icon").addClass("active")),jQuery(e).addClass("active")}function timeLineSwipeHandler(e,t){var i,n,o=jQuery(t).closest(".component_timeline").find(".timelinetabs .desktop-tabs li").length-1,s=jQuery(t).closest(".component_timeline").find(".timelinetabs li.active").index(),a=jQuery(t).closest(".component_timeline").find(".timelinetabs li"),l=jQuery(t).closest(".component_timeline").find(".segments-main"),c=jQuery(t).closest(".component_timeline"),m=0;"left"===e&&s<o&&(a.removeClass("active"),l.removeClass("active"),a.eq(s+1).addClass("active"),l.eq(s+1).addClass("active"),c.find(".timline-unit-status").removeClass("active"),c.find(".timline-unit-status").eq(s+1).addClass("active"),c.find(".segments-main.active").prevAll().each(function(){m+=jQuery(this).outerWidth(!0)}),c.find(".segment-main-inner").animate({left:"-"+m+"px"},{duration:1e3,easing:"easeInOutBack"}),i=c.find(".segments-main.active").attr("id"),n=c.find('.select-options li[datashow = "'+i+'"]').text(),c.find(".menu-dropdown-mobile .select-styled").text(n)),"right"===e&&0<s&&(a.removeClass("active"),l.removeClass("active"),a.eq(s-1).addClass("active"),l.eq(s-1).addClass("active"),c.find(".timline-unit-status").removeClass("active"),c.find(".timline-unit-status").eq(s-1).addClass("active"),c.find(".segments-main.active").prevAll().each(function(){m+=jQuery(this).outerWidth(!0)}),c.find(".segment-main-inner").animate({left:"-"+m+"px"},{duration:1e3,easing:"easeInOutBack"}),i=c.find(".segments-main.active").attr("id"),n=c.find('.select-options li[datashow = "'+i+'"]').text(),c.find(".menu-dropdown-mobile .select-styled").text(n));var r=jQuery(".component_timeline");setTimeout(function(){scroll_to_active_task(r)},700)}function timelineArrows(e){$timeElm=void 0===e?jQuery("body").find(".component_timeline"):jQuery(e).closest(".component_timeline"),setTimeout(function(){total_height=0,$parent_element=$timeElm.find(".segments-main.active"),$timeElm.find(".segments-main.active .segment").each(function(){total_height+=parseInt(jQuery(this).outerHeight(!0))});var e=$parent_element.scrollTop(),t=$parent_element.outerHeight();e+t>(total_height-=20)?($timeElm.find(".arrow-down").addClass("no-timeline"),$timeElm.find(".arrow-up").removeClass("no-timeline"),t>total_height&&$timeElm.find(".arrow-up").addClass("no-timeline")):0>=e?($timeElm.find(".arrow-up").addClass("no-timeline"),$timeElm.find(".arrow-down").removeClass("no-timeline")):($timeElm.find(".arrow-down").removeClass("no-timeline"),$timeElm.find(".arrow-up").removeClass("no-timeline"))},200)}function reset_scroll(e){$elemTime=jQuery(e).closest(".component_timeline"),$elemTime.find(".segments-main").animate({scrollTop:0},{duration:1,easing:"easeInOutBack"})}!function(e){var t=jQuery("[data-js-timeline]");t.length&&(window.addEventListener("orientationchange",initTimeline_on_rotate,!1),jQuery(window).resize(function(){is_mobile()||(clearTimeout(sized),sized=setTimeout(initTimeline,200))}),jQuery(document).ready(function(i){jQuery("html").hasClass("fl-builder-edit")||(initTimeline(),jQuery(".component_timeline .icons h6, .component_timeline .icons .heading-6").on("click",function(){jQuery(this).siblings(".icons").find("button:first").trigger("click")}),jQuery(".component_timeline .arrow-down").on("click",function(){$timeElm=jQuery(this).parents(".component_timeline"),current_scroll_position=$timeElm.find(".segments-main.active").scrollTop(),total_height=0,$timeElm.find(".segments-main.active .segment").each(function(){total_height+=parseInt(jQuery(this).height())}),(scrollHeight=current_scroll_position+parseInt(300))<total_height&&$timeElm.find(".segments-main.active").animate({scrollTop:parseInt(scrollHeight)},{duration:1e3})}),jQuery(".component_timeline .arrow-up").on("click",function(){$timeElm=jQuery(this).closest(".component_timeline"),current_scroll_position=$timeElm.find(".segments-main.active").scrollTop(),0>(scrollHeight=current_scroll_position-parseInt(300))&&(scrollHeight=0),$timeElm.find(".segments-main.active").animate({scrollTop:parseInt(scrollHeight)},{duration:1e3})}),jQuery(".component_timeline .segments-main").on("scroll",function(){timelineArrows()}),jQuery(".component_timeline .timelinetabs li").on("click",function(){var t=jQuery(this).attr("data-show"),i=0,n=jQuery(this).closest(".component_timeline");n.find(".timelinetabs li").removeClass("active"),n.find(".segments-main").removeClass("active"),n.find("#"+t).addClass("active"),n.find(".timline-unit-status, .intro_copy").removeClass("active"),n.find('.timline-unit-status[data-status = "'+t+'"]').addClass("active"),n.find('.intro_copy[data-show = "'+t+'"]').addClass("active"),jQuery(this).addClass("active"),n.find(".segments-main.active").prevAll().each(function(){i+=jQuery(this).outerWidth(!0)}),duration=1e3,n.find(".segment-main-inner").animate({left:"-"+i+"px"},{duration:duration,easing:"easeInOutBack"}),timelineArrows(n),setTimeout(function(){scroll_to_active_task(n)},700),n.find(".icons, .arrow-bottom, .arrow-top").children("span").attr("taonex",-1),n.find("#"+t).find(".icons, .arrow-bottom, .arrow-top").children("span").attr("taonex",0),e(this).attr("aria-selected","true").siblings("li").attr("aria-selected","false"),e(this).parent("ul").hasClass("desktop-tabs")&&(e(".segments-main .icons button",n).attr("disabled","disabled"),e(".segments-main.active .icons button",n).attr("disabled",!1))}),e(".component_timeline .timelinetabs li").on("keydown",function(t){code=t.which?t.which:t.keyCode,13!==code&&32!==code||e(this).trigger("click")}),e(".component_timeline .segmentbox .icons span").on("keydown",function(t){code=t.which?t.which:t.keyCode,13!==code&&32!==code||e(this).trigger("click")}),e(".component_timeline .timeline-detail-section .icon-box span").on("keydown",function(t){code=t.which?t.which:t.keyCode,13!==code&&32!==code||e(this).trigger("click")}),e(".component_timeline .timeline-detail-section .action-button img").on("keydown",function(t){code=t.which?t.which:t.keyCode,13!==code&&32!==code||e(this).trigger("click")}),e(".component_timeline .navigation-select").each(function(){var t=e(this),i=e(this).children("option").length;t.addClass("select-hidden"),t.wrap('<div class="select"></div>'),t.after('<div class="select-styled"></div>');var n=jQuery(this).closest(".component_timeline"),o=t.next("div.select-styled");o.text(t.children("option").eq(0).text());for(var s=e("<ul />",{class:"select-options"}).insertAfter(o),a=0;a<i;a++)e("<li />",{text:t.children("option").eq(a).text(),rel:t.children("option").eq(a).val(),datashow:t.children("option").eq(a).attr("data-show")}).appendTo(s);var l=s.children("li");o.click(function(t){t.stopPropagation(),e("div.select-styled.active").not(this).each(function(){e(this).removeClass("active").next("ul.select-options").hide()}),e(this).toggleClass("active").next("ul.select-options").toggle()}),l.click(function(i){i.stopPropagation(),o.text(e(this).text()).removeClass("active"),t.val(e(this).attr("rel"));var a=e(this).attr("datashow"),l=0;n.find(".segments-main").removeClass("active"),n.find("#"+a).addClass("active"),n.find(".segments-main.active").prevAll().each(function(){l+=jQuery(this).outerWidth(!0)}),duration=1e3,n.find(".segment-main-inner").animate({left:"-"+l+"px"},{duration:duration,easing:"easeInOutBack"}),n.find(".desktop-tabs li").removeClass("active"),n.find(".desktop-tabs li[data-show = '"+a+"']").addClass("active"),n.find(".timline-unit-status").removeClass("active"),n.find('.timline-unit-status[data-status = "'+a+'"]').addClass("active"),s.hide(),setTimeout(function(){scroll_to_active_task(n)},100),e(".segments-main .icons button").attr("disabled","disabled"),e(".segments-main.active .icons button").attr("disabled",!1)}),e(document).click(function(){o.removeClass("active"),s.hide()})}),t.KLightBoxTimeline({}),slickSliderTimeline(),jQuery(".component_timeline [data-js-return-timeline]").on("click",function(){jQuery("body").removeClass("no_scroll"),jQuery(this).closest(".component_timeline").find(".timeline-detail-section-main").hide().removeClass("is-open"),jQuery(this).closest(".segments-main").find('[taonex="-1"]').attr("taonex",0),jQuery(this).closest(".segments-main").find(".timeline-detail-section-main").find('[taonex="0"]').attr("taonex",-1),jQuery(this).closest(".component_timeline").find(".desktop-tabs").find('[taonex="-1"]').attr("taonex",0),jQuery(this).closest(".segments-main.active").find("button.active").focus().removeClass("active"),e([document.documentElement,document.body]).animate({scrollTop:jQuery(this).closest(".fl-module-timeline").offset().top},500)}),jQuery(".component_timeline .icon-box  span").on("click",function(){jQuery(this).closest(".component_timeline").find(".icon-box  span").removeClass("active"),jQuery(this).addClass("active")}),is_mobile()||jQuery(".segments-main").swipe({swipeLeft:function(e,t,i,n,o,s){timeLineSwipeHandler(t,this)},swipeRight:function(e,t,i,n,o,s){timeLineSwipeHandler(t,this)},allowPageScroll:"vertical",threshold:50}))}))}(jQuery),jQuery.fn.KLightBoxTimeline=function(e){var t,i,n=jQuery.noConflict(),o=n.extend({},{effectTime:500,roundK:!0},e),s=".light-box-item",a=0,l=n(this).find(s),c=l.length;function m(){!function(e){var t=jQuery(e).parents("[data-js-timeline]").find(".lightbox-append"),i=n(e).attr("data-show"),o=n(e).attr("data-intro");if("lightbox-video"==i){var s="https://www.youtube.com/embed/"+n(e).attr("data-lightbox"),a='<iframe src="'+s+'?autoplay=true" frameborder="0" allowfullscreen allow="accelerometer; autoplay; encrypted-media; gyroscope"></iframe>';t.html(a),jQuery(e).parents("[data-js-timeline]").find(".lightbox-intro").hide()}else if("lightbox-image"==i){var l=n(e).attr("data-lightbox"),c='<img src="'+l+'"/>';jQuery(e).parents("[data-js-timeline]").find(".lightbox-intro").show().html(o),t.html(c)}}(n(l[a])),n(l[a])?(n(".current-gallery-item").html(a+1),n(".total-gallery-item").html(c)):(n(".current-gallery-item").html(a),n(".total-gallery-item").html(c)),2>c?n(".component_timeline .lightbox-content-box .nav-control").css("opacity",0):n(".component_timeline .lightbox-content-box .nav-control").css("opacity",1)}function r(){n(".component_timeline .segments-main.active .restore0tabs").attr("taonex",0).removeClass("restore0tabs"),n(".component_timeline .segments-main.active .restore_focus").focus().removeClass("restore_focus"),n(".component_timeline .desktop-tabs li").attr("taonex","0"),n(".module-timeline-lightbox-wrap").fadeOut(o.effectTime),n(".module-timeline-lightbox-wrap a").removeClass("is-tabbing"),t=null,i=null,setTimeout(function(){n(".lightbox-append").html(""),n(".lightbox-intro").html("")},500)}function d(e,o){var s=i-1;n(o,e).removeClass("is-tabbing"),n(t[i],e).focus().addClass("is-tabbing"),0==i&&(s=t.length-1),i=s}function u(e,o){var s=1+i;n(o,e).removeClass("is-tabbing"),n(t[i],e).focus().addClass("is-tabbing"),s==t.length&&(s=0),i=s}function h(){a<c-1?(a++,m()):o.roundK&&(a=0,m())}function f(){0<a?(a--,m()):o.roundK&&(a=c-1,m())}n(".component_timeline").find(s).stop().click(function(e){var r,d=n(this).attr("data-gallery");s="."+d,l=n("body").find(s),c=l.length,e.preventDefault(),r=n(this),n(".component_timeline .desktop-tabs li").attr("taonex","-1"),a=n(s).index(r),m(),n(".module-timeline-lightbox-wrap").fadeIn(o.effectTime),n(".current-gallery-item").html(a+1),n('.component_timeline .segments-main.active [taonex="0"]').addClass("restore0tabs").attr("taonex",-1),n(r).find('[role="button"]').addClass("restore_focus"),t=n(".module-timeline-lightbox-wrap a"),i=1<t.length?1:0,n(".module-timeline-lightbox-wrap .lightbox-close").focus()}),n(".component_timeline .lightbox-close").stop().on("click",function(){r()}),n(".component_timeline .nav-next").stop().on("click",function(){h()}),n(".component_timeline .nav-prev").stop().on("click",function(){f()}),n(document).keydown(function(e){var o=e.which?e.which:e.KeyCode,s=e.target.className;switch(o){case 9:n(".component_timeline .module-timeline-lightbox-wrap").is(":visible")?(e.preventDefault(),e.shiftKey?d(n(".component_timeline .module-timeline-lightbox-wrap"),"a"):u(n(".component_timeline .module-timeline-lightbox-wrap"),"a")):n(".component_timeline .timeline-detail-section-main.is-open").length&&(e.preventDefault(),null!=typeof i&&null!=i||(i=1),t=new Array,n(".component_timeline .timeline-detail-section-main.is-open .modal-action").each(function(){n(this).is(":visible")&&t.push(n(this))}),i=i<t.length?i:0,e.shiftKey?d(n(".component_timeline .timeline-detail-section-main.is-open"),".modal-action"):u(n(".component_timeline .timeline-detail-section-main.is-open"),".modal-action"));break;case 39:n(".component_timeline .module-timeline-lightbox-wrap").is(":visible")&&h();break;case 37:n(".component_timeline .module-timeline-lightbox-wrap").is(":visible")&&f();break;case 27:n(".component_timeline .module-timeline-lightbox-wrap").is(":visible")&&r();break;case 13:n(".module-timeline-lightbox-wrap").is(":visible")?"nav-control"!=s.match(/nav\-control/)?n(".module-timeline-lightbox-wrap .lightbox-close").focus():n(e).focus():n(".component_timeline .timeline-detail-section-main").is(":visible")&&("carousel-control"==s.match(/carousel\-control/)?n(e).focus():n(e).trigger("click"))}})};