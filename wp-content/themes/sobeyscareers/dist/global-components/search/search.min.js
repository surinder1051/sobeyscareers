!function(e){var t=e("[data-js-header_search]");if(t.length){e("#site-nav-header");var s,n=e(".component_search"),i=n.data("search-source"),l=e("[data-js-search-load-more]"),o=!1,a=250,r=0,c=".gh-close-button",d="li.gh-menu-item",u=".component_search .field .icon",h=".component_search .live-result",f="-open",p="",m=0,g=function(){e(n).hasClass("-open")&&((s=new Array).push(e(".menu-global-container .gh-close-button a")),s.push(e("#siteSearch",n)),e(".results a",n).each(function(){e(this).attr("tabindex","0"),s.push(e(this))}),e(".load-more button",n).length&&e(".load-more button",n).is(":visible")&&s.push(e(".load-more button",n)))};e(document).ready(function(){t.on("click",k),l.on("click",b),e(document).on("click",c,C),e(document).on("click",u,w),e(document).on("click",h,_),e(document).on("modal-close",C)}),e(".component_search .field input").focusout(function(){e(".live-search-results").fadeOut()}),e(window).on("keydown",function(t){var i;if(e(n).hasClass("-open"))switch(t.which?t.which:t.keyCode){case 9:t.preventDefault(),t.shiftKey?(i=m-1,e(s[m]).focus(),0==m&&(i=s.length-1),m=i):function(){var t=1+m;e(s[m]).focus(),t==s.length&&(t=0),m=t}();break;case 27:C()}}),window.opg_closeHSMenu=function(){C()}}function v(t){suggestion_count=e(".live-search-results .live-result:visible").length;var s=t.which?t.which:t.keyCode;if(13==s)n.find(".live-search-results .selected").length?(val=e(".live-search-results .selected .title").text(),n.find(".field input").val(val),w()):w();else if(40==s){if(!suggestion_count)return;1>n.find(".live-search-results .selected").length?r=1:(r=parseInt(r)+1)>=suggestion_count&&(r=suggestion_count),n.find(".live-search-results .selected").removeClass("selected"),n.find(".live-search-results .live-result:nth-child("+r+")").addClass("selected")}else if(38==s){if(!suggestion_count)return;1>n.find(".live-search-results .selected").length?r=1:0>=(r=parseInt(r)-1)&&(r=1),n.find(".live-search-results .selected").removeClass("selected"),n.find(".live-search-results .live-result:nth-child("+r+")").addClass("selected")}else r=0,val=e(this).val(),function(t){for(var s=[],n=0,i=0;i<o.length&&(0==o[i].indexOf(t)&&(s.push(o[i]),n++),!(2<n));i++);if(e(".live-search-results").hide(),s.length&&t){e(".live-search-results .live-result").hide();for(var i=0;i<s.length;i++)e(".live-search-results .live-result:nth-child("+(i+1)+") .title").text(s[i]).parent().show();e(".live-search-results").show()}}(val),n.find(".live-search-results .selected").removeClass("selected"),n.find(".load-more button").data("paged",0),n.find(".results").html(""),n.find(".pagination, .load-more, .summary").hide(),n.find(".results-count .term").text("0")}function _(){val=e(this).find(".title").text(),e(".component_search .field input").val(val),e(".live-search-results").hide(),w()}function b(){n.find(".load-more button").text("Loading...").attr("disabled","disabled"),w()}function y(e){27===(e.which?e.which:e.keyCode)&&C()}function w(){if(!jQuery(".component_search").hasClass("searching")){jQuery(".component_search").addClass("searching");var t=e(".component_search .field input").val();0!==t.length&&(p!==t&&x(),p=t,e(".component_search .field input").prop("disabled",!0),e(".component_search .field input").val('Searching for "'+t+'" ...'),e("body").hasClass("admin-bar")&&e("html").animate({scrollTop:0},30),function(e){if(e.length)return!0}(t)&&(null==n.find(".load-more button").data("paged")?paged=0:paged=n.find(".load-more button").data("paged"),e.ajax({url:endpoint_search,data:{s:t,search_source:i,paged:paged},type:"GET"}).done(function(s){n.find(".summary").show(),1>s.results?function(){var t=e(".component_search .field input").val();n.find("h5").text("No results for: "+t),x()}():function(t){n.find(".results-count .term").text(t.found_posts),n.find(".summary").show(),start=1+t.max_results*(t.paged-1),scroll_height=0,finish=start+t.max_results-1,finish>=t.found_posts?(finish=t.found_posts,n.find(".load-more").hide().find("button").data("paged",0),pagination_text="Results 1-"+finish):(n.find(".load-more button").text("Load more").attr("disabled",!1),n.find(".pagination, .load-more").show().find("button").data("paged",t.paged),pagination_text="Results 1-"+finish+" of "+t.found_posts);n.find(".pagination h6").text(pagination_text),n.find("h5").text("Search Results: "+t.search_term);for(var s=0;s<t.results.length;s++)link=t.results[s].link,title=t.results[s].title,tag=null,description=null,t.results[s].tag&&(tag=t.results[s].tag),t.results[s].description&&(description=t.results[s].description,description.length>a&&(description=description.substring(1,a)+" ... ")),title&&(result_class=s?"":"scroll_marker",html='<div class="result '+result_class+'">',tag&&(html+='<div class="tag">'+tag+"</div>"),html+='<a target="_blank" title="'+title+'" href="'+link+'">'+title+"</a>",description&&(html+='<p class="description">'+description+"</p>"),html+="</div>",n.find(".results").append(html),scroll_height+=n.find(".results .result:last-child").height());1==t.paged?(scrollPoint=e(".component_search .search-field").height(),e(".component_search").animate({scrollTop:scrollPoint+80},500)):(scrollPoint=e(".component_search").scrollTop()+scroll_height,e(".component_search").animate({scrollTop:scrollPoint+135},500))}(s),e(".component_search .field input").prop("disabled",!1).val(t),g(),m=2,jQuery(".component_search").removeClass("searching")})))}}function x(){n.find("h5").html("Search Results:"),n.find(".results").html(""),n.find(".results-count .term").text("0"),n.find(".pagination").hide(),n.find(".field input").val("")}function k(t){e(document).trigger("menu-close"),e(document).bind("keyup",y),o||e.ajax({url:endpoint_search,data:{autofill_list:!0,search_source:i},type:"GET"}).done(function(e){o=e.sort()}),e("body").addClass("no_scroll"),t.preventDefault(),n.show(),n.addClass(f),n.find(".summary").hide(),e(d).hide(),e(c).show(),e("html, .component_search").animate({scrollTop:0},0),e('.component_search .search-field input[type="text"]').focus(),e(".component_search .field input").bind("keyup",v),g(),m=0}function C(){e(document).unbind("keyup",y),x(),e("body").removeClass("no_scroll"),n.removeClass(f),n.hide(),e(d).show(),e(c).hide(),e(".component_search .field input").unbind("keyup",v)}}(jQuery);