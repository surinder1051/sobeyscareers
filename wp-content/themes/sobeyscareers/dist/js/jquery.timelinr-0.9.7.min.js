jQuery.fn.timelinr=function(s){settings=jQuery.extend({orientation:"horizontal",containerDiv:"#timeline",datesDiv:"#dates",datesSelectedClass:"selected",datesSpeed:"normal",issuesDiv:"#issues",issuesSelectedClass:"selected",issuesSpeed:"fast",issuesTransparency:.2,issuesTransparencySpeed:500,prevButton:"#prev",nextButton:"#next",arrowKeys:"false",startAt:1,autoPlay:"false",autoPlayDirection:"forward",autoPlayPause:2e3},s),function(s){if(0<s(settings.datesDiv).length&&0<s(settings.issuesDiv).length){var t=s(settings.datesDiv+" li").length,e=s(settings.issuesDiv+" li").length,i=(s(settings.datesDiv).find("a."+settings.datesSelectedClass),s(settings.issuesDiv).find("li."+settings.issuesSelectedClass),s(settings.containerDiv).width()),n=s(settings.containerDiv).height(),a=(s(settings.issuesDiv).width(),s(settings.issuesDiv).height(),s(settings.issuesDiv+" li").width()),g=s(settings.issuesDiv+" li").height(),u=(s(settings.datesDiv).width(),s(settings.datesDiv).height(),s(settings.datesDiv+" li").width()),l=s(settings.datesDiv+" li").height();if("horizontal"==settings.orientation){s(settings.issuesDiv).width(a*e),s(settings.datesDiv).width(u*t).css("marginLeft",i/2-u/2);var d=parseInt(s(settings.datesDiv).css("marginLeft").substring(0,s(settings.datesDiv).css("marginLeft").indexOf("px")))}else if("vertical"==settings.orientation){s(settings.issuesDiv).height(g*e),s(settings.datesDiv).height(l*t).css("marginTop",n/2-l/2);d=parseInt(s(settings.datesDiv).css("marginTop").substring(0,s(settings.datesDiv).css("marginTop").indexOf("px")))}if(s(settings.datesDiv+" a").click(function(e){e.preventDefault();s(this).text();var i=s(this).parent().prevAll().length;"horizontal"==settings.orientation?s(settings.issuesDiv).animate({marginLeft:-a*i},{queue:!1,duration:settings.issuesSpeed}):"vertical"==settings.orientation&&s(settings.issuesDiv).animate({marginTop:-g*i},{queue:!1,duration:settings.issuesSpeed}),s(settings.issuesDiv+" li").animate({opacity:settings.issuesTransparency},{queue:!1,duration:settings.issuesSpeed}).removeClass(settings.issuesSelectedClass).eq(i).addClass(settings.issuesSelectedClass).fadeTo(settings.issuesTransparencySpeed,1),1==t?s(settings.prevButton+","+settings.nextButton).fadeOut("fast"):2==t?s(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?(s(settings.prevButton).fadeOut("fast"),s(settings.nextButton).fadeIn("fast")):s(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)&&(s(settings.nextButton).fadeOut("fast"),s(settings.prevButton).fadeIn("fast")):s(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?(s(settings.nextButton).fadeIn("fast"),s(settings.prevButton).fadeOut("fast")):s(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)?(s(settings.prevButton).fadeIn("fast"),s(settings.nextButton).fadeOut("fast")):s(settings.nextButton+","+settings.prevButton).fadeIn("slow"),s(settings.datesDiv+" a").removeClass(settings.datesSelectedClass),s(this).addClass(settings.datesSelectedClass),"horizontal"==settings.orientation?s(settings.datesDiv).animate({marginLeft:d-u*i},{queue:!1,duration:"settings.datesSpeed"}):"vertical"==settings.orientation&&s(settings.datesDiv).animate({marginTop:d-l*i},{queue:!1,duration:"settings.datesSpeed"})}),s(settings.nextButton).bind("click",function(i){i.preventDefault();var n=s(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();if("horizontal"==settings.orientation){u=parseInt(s(settings.issuesDiv).css("marginLeft").substring(0,s(settings.issuesDiv).css("marginLeft").indexOf("px"))),parseInt(s(settings.datesDiv).css("marginLeft").substring(0,s(settings.datesDiv).css("marginLeft").indexOf("px")));u<=-(a*e-a)?(s(settings.issuesDiv).stop(),s(settings.datesDiv+" li:last-child a").click()):s(settings.issuesDiv).is(":animated")||s(settings.datesDiv+" li").eq(n+1).find("a").trigger("click")}else if("vertical"==settings.orientation){var u;u=parseInt(s(settings.issuesDiv).css("marginTop").substring(0,s(settings.issuesDiv).css("marginTop").indexOf("px"))),parseInt(s(settings.datesDiv).css("marginTop").substring(0,s(settings.datesDiv).css("marginTop").indexOf("px")));u<=-(g*e-g)?(s(settings.issuesDiv).stop(),s(settings.datesDiv+" li:last-child a").click()):s(settings.issuesDiv).is(":animated")||s(settings.datesDiv+" li").eq(n+1).find("a").trigger("click")}1==t?s(settings.prevButton+","+settings.nextButton).fadeOut("fast"):2==t?s(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?(s(settings.prevButton).fadeOut("fast"),s(settings.nextButton).fadeIn("fast")):s(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)&&(s(settings.nextButton).fadeOut("fast"),s(settings.prevButton).fadeIn("fast")):s(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?s(settings.prevButton).fadeOut("fast"):s(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)?s(settings.nextButton).fadeOut("fast"):s(settings.nextButton+","+settings.prevButton).fadeIn("slow")}),s(settings.prevButton).click(function(e){e.preventDefault();var i=s(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();if("horizontal"==settings.orientation){n=parseInt(s(settings.issuesDiv).css("marginLeft").substring(0,s(settings.issuesDiv).css("marginLeft").indexOf("px"))),parseInt(s(settings.datesDiv).css("marginLeft").substring(0,s(settings.datesDiv).css("marginLeft").indexOf("px")));0<=n?(s(settings.issuesDiv).stop(),s(settings.datesDiv+" li:first-child a").click()):s(settings.issuesDiv).is(":animated")||s(settings.datesDiv+" li").eq(i-1).find("a").trigger("click")}else if("vertical"==settings.orientation){var n;n=parseInt(s(settings.issuesDiv).css("marginTop").substring(0,s(settings.issuesDiv).css("marginTop").indexOf("px"))),parseInt(s(settings.datesDiv).css("marginTop").substring(0,s(settings.datesDiv).css("marginTop").indexOf("px")));0<=n?(s(settings.issuesDiv).stop(),s(settings.datesDiv+" li:first-child a").click()):s(settings.issuesDiv).is(":animated")||s(settings.datesDiv+" li").eq(i-1).find("a").trigger("click")}1==t?s(settings.prevButton+","+settings.nextButton).fadeOut("fast"):2==t?s(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?(s(settings.prevButton).fadeOut("fast"),s(settings.nextButton).fadeIn("fast")):s(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)&&(s(settings.nextButton).fadeOut("fast"),s(settings.prevButton).fadeIn("fast")):s(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?s(settings.prevButton).fadeOut("fast"):s(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)?s(settings.nextButton).fadeOut("fast"):s(settings.nextButton+","+settings.prevButton).fadeIn("slow")}),"true"==settings.arrowKeys&&("horizontal"==settings.orientation?s(document).keydown(function(t){39==t.keyCode&&s(settings.nextButton).click(),37==t.keyCode&&s(settings.prevButton).click()}):"vertical"==settings.orientation&&s(document).keydown(function(t){40==t.keyCode&&s(settings.nextButton).click(),38==t.keyCode&&s(settings.prevButton).click()})),s(settings.datesDiv+" li").eq(settings.startAt-1).find("a").trigger("click"),"true"==settings.autoPlay){var r=setInterval(autoPlay,settings.autoPlayPause);s(settings.containerDiv).hover(function(s){clearInterval(r)},function(s){r=setInterval(autoPlay,settings.autoPlayPause)})}}}(jQuery)};